# Development image with devDependencies (nodemon / ts-node-dev)
FROM node:22

WORKDIR /app

# Copy package files and install ALL dependencies
COPY package*.json ./
RUN npm ci

# Copy everything
COPY . .

# Ensure user-content/images exists
RUN mkdir -p /app/src/user-content/images

ENV NODE_ENV=development

# Use the npm dev script which starts ts-node-dev
CMD ["npm", "run", "dev"]